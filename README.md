# Task 4: Data Storage

## Задание по теме “Хранение данных” - дополнение к предыдущему заданию.

### Цель задания - закрепить навыки сохранения объектов в базу данных CoreData.

### Используемые инструменты: UITabbarController, CoreData, NSFetchedResultsController.
Примечание: используем знания из урока по архитектуре и содержим всю логику с
работой с базой данных в одном слое.

## Описание задания:
1. Обернуть приложение в UITabbarController. Исходная вкладка - со списком
персонажей называется “Персонажи”, вторая вкладка - Загруженное. (Иконки ко
вкладкам можно выбрать либо системные, либо добавить свои - по
усмотрению.)

2. На экране карточки персонажа добавить кнопку (как вариант UIBarButtonItem на
UINavigationBar) - которая будет отвечать за добавление персонажа в список
загруженного. Заголовок кнопки - если персонаж не добавлен в список
загруженного - “Загрузить”, если он уже там есть - “Удалить”. По нажатию
кнопки выполняем следующие действия:
- Если персонаж не загружен:
    * Добавляем информацию о персонаже в CoreData
    * Обновляем экран списка загруженных персонажей.
- Если персонаж уже загружен
    * Удаляем информацию о персонаже из CoreData
    * Обновляем экран списка загруженных персонажей.

3. На вкладке Загруженное подключить NSFetchedResultsController для показа и
редактирования загруженных персонажей. Дизайн элемента списка (табличной ячейки,
экрана целиком) - аналогичен экрану списка на первой вкладке. Список загруженных
персонажей должен динамически изменяться при удалении или добавлении
персонажа с экрана карточки.

4. Реализовать возможность удалять персонажей из списка загруженных свайпом по
табличной ячейке.

5. При нажатии на ячейку осуществлять переход на карточку персонажа, при этом на
карточке должна быть доступна вся информация (эпизоды, местоположение), что и на
карточке персонажа, загруженного с сервера!
Важно: вся информация на экране “Загруженное” (список персонажей, детальная
информация о персонажах для карточки) кроме картинки (сохранять только url)
должна быть доступна без интернета!

6. Дополнительное задание
- Сделать третью вкладку в UITabbarController - настройки.
- На этом экране сделать переключатель - UISwitch в связке с UILabel -
Разрешать сохранять персонажей.
- Сохранять значение UISwitch и при каждом запуске передавать ему актуальное
сохраненное значение.
- Меняем логику нажатия кнопки Загрузить/Удалить на карточке персонажа - если
мы запретили загружать персонажа - показываем UIAlertController со
следующим текстом - “Чтобы загрузить этого персонажа, необходимо дать
разрешение в настройках” и кнопкой “Ок”, которая закрывает UIAlertController.
- Если мы запрещаем загружать персонажей, но у нас уже на этот момент
сохранено несколько персонажей, то при выключении UISwitch, удаляем всех
сохраненных персонажей.
